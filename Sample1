import re
import csv

def extract_dml_info(dml_file):
    pattern = r"string\((\+|\-), maximum_length=(\d+)\) (\w+) = (NULL|NOT NULL)\(\"\"\)\;"
    matches = re.findall(pattern, dml_file)

    extracted_info = []
    for match in matches:
        data_type, maximum_length, field_name, null_or_not_null = match
        extracted_info.append((data_type, maximum_length, field_name, null_or_not_null))

    return extracted_info

# Replace 'your_dml_file.txt' with the actual path to your DML file
with open('your_dml_file.txt', 'r') as file:
    dml_content = file.read()

dml_info = extract_dml_info(dml_content)

# Write the extracted information to a CSV file
with open('extracted_dml_info.csv', 'w', newline='') as csv_file:
    csv_writer = csv.writer(csv_file)
    csv_writer.writerow(['Data Type', 'Maximum Length', 'Field Name', 'Null or Not Null'])
    csv_writer.writerows(dml_info)
