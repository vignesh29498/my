import pandas as pd
import re

# Read the CSV file
df = pd.read_csv('output_file_key_value.csv')

# Lists to hold extracted sizes
varchar_sizes = []
char_sizes = []

# Function to extract sizes from a value
def extract_lengths(value):
    # Extract size for VARCHAR2
    size_match = re.search(r'VARCHAR2(\d+)', value)
    varchar_size = size_match.group(1) if size_match else None
    
    # Extract size for CHAR
    char_size_match = re.search(r'CHAR(\d+)', value)
    char_size = char_size_match.group(1) if char_size_match else None
    
    return varchar_size, char_size

# Loop through each value in the DataFrame
for value in df['Value']:
    varchar_size, char_size = extract_lengths(str(value))
    
    # Append sizes to their respective lists
    varchar_sizes.append(varchar_size)
    char_sizes.append(char_size)

# Create a DataFrame with the results
results = pd.DataFrame({
    'VARCHAR2 Sizes': varchar_sizes,
    'CHAR Sizes': char_sizes
})

# Display the resulting DataFrame
print(results)
