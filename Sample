import pandas as pd

# Load the CSV file
file_path = 'your_file.csv'  # Replace with your CSV file path
df = pd.read_csv(file_path)

# Function to predict data type of a column
def predict_data_type(col):
    if col.apply(lambda x: isinstance(x, int)).all():
        return 'int'
    elif col.apply(lambda x: isinstance(x, float)).all():
        return 'float'
    elif col.apply(lambda x: isinstance(x, str)).all():
        return 'string'
    else:
        return 'mixed'

# Initialize dictionaries to store results
column_data_types = {}
column_value_lengths = {}
columns_with_similar_values = []

# Analyze each column
for col in df.columns:
    column_data_types[col] = predict_data_type(df[col])
    column_value_lengths[col] = df[col].apply(lambda x: len(str(x)) if pd.notnull(x) else 0).tolist()
    if df[col].nunique() == 1:
        columns_with_similar_values.append(col)

# Print results
print("Column Data Types:")
for col, dtype in column_data_types.items():
    print(f"{col}: {dtype}")

print("\nColumn Value Lengths:")
for col, lengths in column_value_lengths.items():
    print(f"{col}: {lengths[:5]}")  # Displaying first 5 lengths for brevity

print("\nColumns with All Similar Values:")
for col in columns_with_similar_values:
    print(col)
