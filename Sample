import pandas as pd

# Load the CSV file into a DataFrame
df = pd.read_csv('sample_data.csv')

# Limit the DataFrame to the first 1000 rows
df = df.head(1000)

# Function to check if the number of mismatches in data types in a column is within the allowed limit
def check_column_type_with_tolerance(column, tolerance=5):
    if column.isnull().all():
        return False  # Treat empty columns as having mixed data types
    type_counts = column.map(type).value_counts()
    most_common_type_count = type_counts.iloc[0]
    total_mismatches = len(column) - most_common_type_count
    return total_mismatches <= tolerance

# Iterate through each column and check if the data types are similar within the allowed tolerance
for column in df.columns:
    if check_column_type_with_tolerance(df[column]):
        print(f"Column '{column}' has consistent data types within tolerance.")
    else:
        if df[column].isnull().all():
            print(f"Column '{column}' is completely empty.")
        else:
            print(f"Column '{column}' exceeds the mismatch tolerance.")
