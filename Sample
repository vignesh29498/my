import pandas as pd
import random

def read_csv(file_path):
    return pd.read_csv(file_path)

def find_matches(sample_row, df2):
    matched_data = []
    unmatched_data = []

    for col in sample_row.index:
        value = sample_row[col]
        if any(df2.apply(lambda row: value in row.values, axis=1)):
            matched_data.append((col, value))
        else:
            unmatched_data.append((col, value))
    
    return matched_data, unmatched_data

def get_sample_row(df, sample_index=None):
    if sample_index is not None:
        sample_row = df.iloc[sample_index]
    else:
        random_index = random.randint(0, len(df) - 1)  # Select a random index
        sample_row = df.iloc[random_index]
    return sample_row

def process_files(file1_path, file2_path, sample_index=None):
    df1 = read_csv(file1_path)
    df2 = read_csv(file2_path)
    sample_row = get_sample_row(df1, sample_index)

    matched_data, unmatched_data = find_matches(sample_row, df2)

    return matched_data, unmatched_data

def main():
    file1_path = 'path_to_first_csv_file.csv'
    file2_path = 'path_to_second_csv_file.csv'
    
    # Set to None to take a random sample row or specify the sample row index
    sample_index = None  # Change to a specific index if you want to use a specific row

    matched_data, unmatched_data = process_files(file1_path, file2_path, sample_index)

    if matched_data:
        print("Matched Data:")
        for col, value in matched_data:
            print(f"Column: {col}, Value: {value}")
    else:
        print("No matches found.")

    if unmatched_data:
        print("\nUnmatched Data:")
        for col, value in unmatched_data:
            print(f"Column: {col}, Value: {value}")
    else:
        print("All values matched.")

if __name__ == "__main__":
    main()
